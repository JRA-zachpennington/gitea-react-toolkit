---
name: Tree
route: /tree
---
import { useState } from 'react';
import { Playground, Props } from 'docz';
import { Paper, Card, CardContent, CardHeader } from '@material-ui/core';
import { Tree, TreeObject, BlobObject, withBlob } from './';

import { humanFileSize } from './helpers';

# Tree Components

There are three components that work together to render a Git Tree.

1. The [withBlob HOC](/tree#withblob-hoc)  is a Higher Order Component that wraps any component with access to a blob, and a tree to select one.
1. The [Tree Component](/tree#tree-component) is a higher level component that brings it all together, and renders a Tree Object Component.
1. The [TreeObject Component](/tree#treeobject-component) is a recursive component that renders a tree object and renders a Blob Object Component for each child Blob.
1. The [BlobObject Component](/tree#blobobject-component) is a component that renders a blob object.

These are based off of the documentation for the following Git Tree implementations:
- <a href='https://try.gitea.io/api/swagger#/repository/GetTree' target='_blank'>Gitea's Git Tree Rest API v1</a>
- <a href='https://developer.github.com/v3/git/trees/' target='_blank'>Github's Git Tree Rest API v3</a>

## withBlob HOC

You can wrap any component with `withBlob` Higher Order Component so that you can require a blob object for the component.
It will also give access to the selected blob object through the props of the children.
If a blob is not already selected, it will render the Tree component for selection using the blobConfig.

<Playground>
{() => {
  // Define your React component and optionally access blob in props.
  function Component({
    blob,
  }) {
    return (
      <Card>
        <CardHeader title={<strong>{blob.path}</strong>} subheader={humanFileSize(blob.size)} />
        <CardContent>
          <pre>{JSON.stringify(blob, null, 2)}</pre>
        </CardContent>
      </Card>
    )
  }
  /** Usually you would wrap it during export at the bottom of your component's file.
   *  export default withRepository(Component);
   */
  const BlobComponent = withBlob(Component);
  // Then you can use your blob wrapped component.
  // const [blob, setBlob] = useState();
  return (
    <Paper>
      <BlobComponent
        //** Pass any props as you normally would. */
        blobConfig={{
          url:"https://bg.door43.org/api/v1/repos/unfoldingWord/en_ta/git/trees/master",
        }}
        /** Pass a previously returned repository object to skip authentication form.
          blob={blob}
          onBlob={(_blob) => {
            setBlob(_blob);
          }}
          */
      />
    </Paper>
  );
}}
</Playground>

<Props of={withBlob} />

## Tree Component

The Tree component accepts a tree (an array of tree objects),
or a url to fetch a tree from.

### Example 1

A manually provided tree listing.

<Playground>
<Paper>
  <Tree
    selected
    onBlob={(data) => alert(JSON.stringify(data, null, 2))}
    tree={[
      {
        "path": ".github",
        "type": "tree",
        "tree": [
          {
            "path": "config",
            "type": "blob",
          },
        ]
      },
      {
        "path": "LICENSE.md",
        "type": "blob",
      }
    ]}
  />
</Paper>
</Playground>

### Example 2

An automated tree listing from a Git Tree API url. Click on the tree objects to see them populate!

<Playground>
<Paper>
  <Tree
    selected
    url="https://api.github.com/repos/unfoldingword-box3/git-file-explorer/git/trees/748bc59ef4d5ac9bbacbe6f3d3f3604775540fee"
    onBlob={(data) => alert(JSON.stringify(data, null, 2))}
  />
</Paper>
</Playground>

<Props of={Tree} />


### Sample Data
```json
[
  {
    "path": ".github",
    "type": "tree",
    ...
  },
  {
    "path": "LICENSE.md",
    "type": "blob",
    ...
  }
]
```


## TreeObject Component

The TreeObject Component is a recursive component that renders more trees
when it encouters an object in the tree of type tree.

### Example

<Playground>
<Paper>
  <TreeObject
    path=""
    type="tree"
    selected
    pathSelected="LICENSE.md"
    tree={[
      {
        "path": ".github",
        "type": "tree"
      },
      {
        "path": "content",
        "type": "tree"
      },
      {
        "path": "LICENSE.md",
        "type": "blob"
      },
      {
        "path": "README.md",
        "type": "blob"
      },
    ]}
    onBlob={(data) => alert(JSON.stringify(data, null, 2))}
  />
</Paper>
</Playground>

<Props of={TreeObject} />

### Sample Data
```json
{
  "path": ".github",
  "type": "tree",
  ...
}
```


## BlobObject Component

### Example
Here are a few variations of the File component being rendered.
Even though it appears to be a nested tree, it is simulated.
You would typically use another component to render more than one.

<Playground>
{() => {
  function Component({
    blobs,
  }) {
    const [_blob, _setBlob] = useState();
    const blobComponents = blobs.map((item) => {
      const key = JSON.stringify(item);
      const selected = (JSON.stringify(item) === JSON.stringify(_blob))
      return (
        <Paper key={key} style={{margin: '1em 0'}}>
          <BlobObject
            blob={item.blob}
            selected={selected}
            onBlob={_setBlob}
          />
        </Paper>
      );
    });

    return (
      <div>
        {blobComponents}
        <h3>Selected Blob:</h3>
        <Paper>
          <pre>{JSON.stringify(_blob, null, 2)}</pre>
        </Paper>
      </div>
    );
  }

  return (
    <Component
      blobs={[
        { blob: { path: "LICENSE.md", size: 1100 }, depth: 1 },
        { blob: { path: "readme.md", size: 1500 }, depth: 2 },
        { blob: { path: "01.md", size: 20000 }, depth: 3 },
        { blob: { path: "title.md", size: 200 }, depth: 3 },
      ]}
    />
  );
}}
</Playground>

<Props of={BlobObject} />

### Sample Data
```json
{
  "path": "LICENSE.md",
  "type": "blob",
  ...
}
```
